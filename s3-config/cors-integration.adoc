---
permalink: s3-config/cors-integration.html
sidebar: sidebar
keywords: cors, cross-origin resource sharing, domain, same origin, s3, s3 api, buckets, nas
summary: "Beginning with ONTAP 9.16.1, you can securely access your S3 buckets using a web browser. Access is provided through an implementation of the Cross-Origin Resource Sharing (CORS) security recommendation. You need to define CORS rules in ONTAP to activate and use the feature."
---

= CORS integration for accessing S3 buckets
:icons: font
:imagesdir: ../media/

[.lead]
Beginning with ONTAP 9.16.1, you can securely access your S3 buckets using a web browser. Access is provided through an implementation of the Cross-Origin Resource Sharing (CORS) security recommendation. You need to define CORS rules in ONTAP to activate and use the feature.

DP: Add page, The presence of the Origin request header in HTTP request indicates a cross domain request that invokes CORS processing.

== CORS concepts and terminology

CORS is a framework built on HTTP that allows scripts defined in one web page to access resources at a server in a different domain. The framework is used to securely bypass the same-origin policy which is a foundation for web security. The key concepts and terminology are described below.

Origin::
>> FS 8.4
An origin is defined as a combination of a URI scheme or protocol, host name, and port number. For example:

`https://www.mycompany.com:8001`

It is used to uniquely identify and locate resources on the internet.

.Same-origin policy
The same-origin policy (SOP) is a security restriction applied to browser-based scripts and a foundation for internet security. It allows scripts initially loaded from one web page to access data in another page if the pages are in the same _origin_. This limitation prevents a script in one page from accessing the data in another page.

.Common CORS use cases
There are several general use cases for CORS, including:

* Cross-domain AJAX requests
* Single-page applications
* Cross-domain fonts, stylesheets, and scripts
* Cross-domain embedding
* Cross-domain authentication

.HTTP headers
CORS is implemented primarily using HTTP headers inserted into the requests and responses. For example, there are several access control response headers that indicate what operations are allowed, including methods and headers.

.HTTP preflight request
This is an optional request to initial determine if a server supports CORS including the indicated methods and headers.

== CORS implementation in ONTAP

>> Find place for FS 8.7

CORS is enabled by default with ONTAP 9.16.1 and later releases. You need to configure CORS for each SVM where it will be active.

[NOTE]
There is no administrative option to disable CORS for an ONTAP cluster. However, you can effectively disable it by not creating any rules or deleting all the existing rules.

=== Accessing ONTAP buckets

CORS is implemented in ONTAP to allow access buckets.

>> two types
>> See FS section 3
>>> You can use it to access both NAS and S3 buckets. See FS at top of terminology section.

=== Possible use cases

For ONTAP buckets with a CORS configuration, there are several possible topologies for cross domain resource access. Access is supported between the following:

* ONTAP S3 buckets (within the same or different SVM or cluster)
* ONTAP NAS buckets (within the same or different SVM or cluster)
* ONTAP S3 and ONTAP NAS buckets (within the same or different SVM or cluster)
* ONTAP buckets and external vendor buckets (AWS, Azure, StorageGrid)
* Buckets in different timezones

=== Requirements and recommendationx

xxx
>> FS 4

>> To revert, all CORS config must be removed FS 7.4.2

=== Defining CORS rules

DP: Add page, "sample object access requests and responses"

To activate CORS, you need to configure rules. There are three actions supported in ONTAP:

* Show
* Create
* Delete

A rule is defined in ONTAP using several properties, including:

* vserver or SVM
* bucket name
* index
* Allowed origins
* Allowed methods
* Allowed headers

See <<Administering CORS using the CLI>> for more information.

>> FS 10.1 and CLI commands

=== Basic  operation

xxx

=== Administration options

You can administer CORS at your ONTAP cluster using either the CLI or REST API.

.ONTAP command line interface

xxx

See <<Administering CORS using the CLI>> for more information.

.ONTAP REST API

xxx
>> FS 8.10

See https://docs.netapp.com/us-en/ontap-automation/[ONTAP Automation^] for more information.

.S3 APIs
xxx

== Administering CORS using the CLI

xxx
>> rules
>> email with questions about more examples and get/next

[NOTE]
You need to be in the ONTAP *admin* privilege level to issue the CORS commands at the CLI.
>> FS 18.1, need admin pro

=== Show

You can use use the command `vserver object-store-server bucket cors-rule create` to display a list of the current rules and the contents of a specific rule

=== Create

You can define a CORS rule using the command `vserver object-store-server bucket cors-rule create`. The required parameters are described in the table below.

[cols="25,75"*,options="header"]
|===
|Parameter
|Description
|`allowed-origins`
|MAN PAGES
|`allowed-methods`
|MAN PAGES
|===

xxx

----
Here is a sample with
another line.
----

=== Delete

xxx
>> need to determine index and then delete using that value
The required parameters are described in the table below.

[cols="25,75"*,options="header"]
|===
|Parameter
|Description
|`vserver`
|MAN PAGES
|`index`
|MAN PAGES
|===

xxx

----
Here is a sample with
another line.
----

>> Do get first? Then delete?

=== Modify

An option to modify a CORS rule is not supported. To modify a rule you should do the following:

. Display the existing rule using the `show` option
. Delete the existing rule
. Create a new rule with the desired options

// DP - October 14 2024 - ONTAPDOC-2323
