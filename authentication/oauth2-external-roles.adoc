---
sidebar: sidebar
permalink: authentication/oauth2-external-roles.html
keywords: oauth 2.0, oauth2, external roles, external role mapping
summary: "An external role is defined at an identify provider configured for use by ONTAP. You can create and administer the mapping relationships between these external roles and the ONTAP roles using the ONTAP CLI."
---

= External role mapping
:hardbreaks:
:nofooter:
:icons: font
:linkattrs:
:imagesdir: ./media/

[.lead]
An external role is defined at an identify provider configured for use by ONTAP. You can create and administer the mapping relationships between these external roles and the ONTAP roles using the ONTAP CLI.

[NOTE]
You can also configure the external role mapping feature using the ONTAP REST API. Learn more at https://docs.netapp.com/us-en/ontap-automation/[ONTAP Automation^].

.Related information

* https://docs.netapp.com/us-en/ontap-cli/[ONTAP CLI commands^].

== External roles in an access token

Here is an example of an OAuth 2.0 access token with two external roles.

[source,json]
{
  "aud": "api://65ba992b-a1df-41a4-9c1c-cddee66baac4",
  "iss": "https://sts.windows.net/bf20ce5a-450b-4737-959b-658f64c2b311/",
  "iat": 1711715873,
  "nbf": 1711715873,
  "exp": 1711720101,
  "acr": "1",
  "aio": "E2MAAtVrR9LfBuavl/5wMn/rsbfnWv+5Feh6z+rdZDjhTmNHKLNl1q95PzM7qzMdOut6vLUA",
  "amr": [
    "pwd"
  ],
  "appid": "65ba992b-a1df-41a4-9c1c-cddee66baac4",
  "appidacr": "1",
  "family_name": "User",
  "given_name": "Test",
  "ipaddr": "202.3.121.6",
  "name": "Test User 1",
  "oid": "3d1115c7-5c50-40a7-bf6c-096fa41368ab",
  "rh": "0.AS0AWs4gvwtFN0eVm2WPZMKzESuZumXfoaRBnBzN3uZrqsT3AEo.",
  "roles": [
    "Global Administrator",
    "Application Administrator"
  ],
  "scp": "DefaultScope",
  "sub": "byDLaSl800UTwwFZcQqhBOGReyhlLEcFtTNu-XKcxWQ",
  "tid": "bf20ce5a-450b-4737-959b-658f64c2b311",
  "unique_name": "testuser1@netappiamsecdev.onmicrosoft.com",
  "upn": "testuser1@netappiamsecdev.onmicrosoft.com",
  "uti": "vYA0hsCuh0q5pPVyfgQaAA",
  "ver": "1.0",
  "wids": [
    "62e90394-69f5-4237-9190-012177145e10",
    "88d8e3e3-8f55-4a1e-953a-9b9898b8876b",
    "9b895d92-2cd3-44c7-9d02-a6ac2d5ea5c3",
    "fdd7a751-b60b-444a-984c-02652fe8fa1c",
    "b79fbf4d-3ef9-4689-8143-76b194e85509"
  ]
}

== Configuration

You can use the ONTAP command line interface to administer the external role mapping feature.

=== Create

You can define a role mapping configuration with the `security login external-role-mapping create` command. You need to be at the ONTAP *admin* privilege level to issue this command as well as the related options.

.Parameters
The parameters used to create a group mapping are described below.

[cols="30,70"*,options="header"]
|===
|Parameter
|Description
|`external-role`
|The name of the role defined at the external identity provider.
|`provider`
|The name of the identity provider. This should be the identifier for the system.
|`ontap-role`
|Indicates the existing ONTAP role the external role is mapped to.
|===

.Example
----
security login external-role-mapping create -external-role "Global Administrator" -provider entra -ontap-role admin
----

=== Additional CLI operations

The command supports several additional operations, including:

* Show
* Modify
* Delete

Refer to the ONTAP commands reference documentation or ONTAP CLI man pages for more information.

// DMP - November 5 2024 - ONTAPDOC-2163
