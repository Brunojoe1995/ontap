---
sidebar: sidebar
permalink: authentication/oauth2-identity-mapping.html
keywords: oauth 2.0, oauth2, identity mapping, group uuid, group name, group mapping, external roles, role mapping
summary: "Beginning with ONTAP 9.16.1, you can use Microsoft Entra ID (formerly Azure AD) as an OAuth 2.0 authorization server. Several identity mapping features have been introduced to support Entra ID for customers who want to enable group support. You can also use these features with other authorization servers as indicated."
---

= Mapping groups and roles
:hardbreaks:
:nofooter:
:icons: font
:linkattrs:
:imagesdir: ./media/

[.lead]
Beginning with ONTAP 9.16.1, you can use Microsoft Entra ID (formerly Azure AD) as an OAuth 2.0 authorization server. Several identity mapping features have been introduced to support Entra ID for customers who want to enable group support. You can also use these features with other authorization servers as indicated.

== Manage group UUIDs with the ONTAP CLI

Microsoft Entra ID represents groups using UUID values rather than names. Two new mapping features have been introduced to adapt this format to ONTAP. You can also use these mapping capabilities with other authorization servers that represent groups as UUID values. However, with ONTAP 9.16.1 they have only been validated with Microsoft Entra ID.

[NOTE]
You can also configure the features using the ONTAP REST API. See the https://docs.netapp.com/us-en/ontap-automation/[ONTAP Automation^] documentation site for more information.

.Related information

* https://docs.netapp.com/us-en/ontap-cli/[ONTAP CLI commands^]

=== Group UUID to group name mapping
// FS 8.3.11

If you're using Entra ID or another authorization server that represents groups using UUID values, you need to map the group UUIDs to group names. The primary ONTAP CLI operations are described below. You need to be at the ONTAP *admin* privilege level to issue the commands.

==== Create

You can define a new group mapping configuration with the `security login group create` command.

.Parameters
The parameters used to create a group mapping are described below.

[cols="30,70"*,options="header"]
|===
|Parameter
|Description
|`vserver`
|Optionally specifies the name of the SVM (vserver) the group is associated with. If omitted, the group is associated with the ONTAP cluster.
|`name`
|The unique name of the group that ONTAP will use.
|`type`
|This value indicates the identity provider the group originates from.
|`uuid`
|Specifies the universally unique identifier of the group as provided by the authorization server.
|===

.Example
----
security login group create -vserver ontap-cls-1 -name Eng_Sec -type entra -uuid acdd070d-8c4c-4f0d-9d8a-162843c10334
----

After creating the group, a unique read-only integer identifier is generated for the group.

==== Additional CLI operations

The command supports several additional operations, including:

* Show
* Modify
* Delete

You can retrieve the unique group ID generated for a group using the `show` option. Refer to the ONTAP commands reference documentation or ONTAP CLI man pages for more information.

=== Group UUID to role mapping
// FS 8.3.13, 8.3.14

If you're using Entra ID or another authorization server that represents groups using UUID values, you can optionally map a group to a role. The primary ONTAP CLI operations are described below. Also, you need to be at the ONTAP *admin* privilege level to issue the commands.

[NOTE]
You need to first define the <<Group UUID to group name mapping>>. After that you can retrieve the unique ID generated for the group which you'll need to map the group to a role.

==== Create

You can define a new role mapping with the `security login group role-mapping create` command.

.Parameters
The parameters used to map a group to a role are described below.

[cols="30,70"*,options="header"]
|===
|Parameter
|Description
|`group-id`
|Specifies the unique ID generated for the group using the command `security login group create`.
|`role`
|The name of the ONTAP role the group is mapped to.
|===

.Example
----
security login group role-mapping create -group-id 1 -role admin
----

==== Additional CLI operations

The command supports several additional operations, including:

* Show
* Modify
* Delete

Refer to the ONTAP commands reference documentation or ONTAP CLI man pages for more information.

== Administer external role mapping with the ONTAP CLI
// FS 8.3.15, 8.3.16

An external role is defined at an identify provider configured for use by ONTAP. You can create and administer the mapping relationships between these external roles and the ONTAP roles. The primary ONTAP CLI operations are described below. You need to be at the ONTAP *admin* privilege level to issue the commands.

[NOTE]
You can also configure the external role mapping feature using the ONTAP REST API. Learn more at https://docs.netapp.com/us-en/ontap-automation/[ONTAP Automation^].

.Related information

* https://docs.netapp.com/us-en/ontap-cli/[ONTAP CLI commands^].

==== Create

You can define a role mapping configuration with the `security login external-role-mapping create` command.

.Parameters
The parameters used to create a group mapping are described below.

[cols="30,70"*,options="header"]
|===
|Parameter
|Description
|`external-role`
|The name of the role defined at the external identity provider.
|`provider`
|The name of the identity provider. This should be the identifier for the system.
|`ontap-role`
|Indicates the existing ONTAP role the external role is mapped to.
|===

.Example
----
security login external-role-mapping create -external-role Administrator -provider entra -ontap-role admin
----

==== Additional CLI operations

The command supports several additional operations, including:

* Show
* Modify
* Delete

Refer to the ONTAP commands reference documentation or ONTAP CLI man pages for more information.

// DMP - Oct 24 2024 - ONTAPDOC-2163
